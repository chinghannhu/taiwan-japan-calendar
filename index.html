<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="台灣日本月曆生成器 - 支援多語言的線上月曆工具，包含節日顯示。">
    <meta name="keywords" content="月曆,日曆,台灣節日,日本節日,線上工具,calendar">
    <meta name="author" content="Taiwan Japan Calendar Generator">
    <title>台灣日本月曆生成器</title>
    
    <!-- Google Fonts - Multi-language Typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@100..800&family=Noto+Sans+TC:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- SVG favicon (現代瀏覽器) -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <!-- PNG favicon (後備選項) -->
    <link rel="icon" type="image/png" href="favicon.png">
    <!-- ICO favicon (舊版瀏覽器) -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-optical-sizing: auto;
            font-weight: 400;
            font-style: normal;
            background: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
            color: #333333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333333;
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 700;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: none;
            color: #333333;
        }

        .subtitle {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 400;
            opacity: 0.7;
            font-size: 1.1em;
            color: #666666;
        }

        .controls {
            padding: 30px;
            background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .control-group {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            align-items: end;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 600;
            color: #333333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .form-group select,
        .form-group input {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 400;
            padding: 12px 20px;
            border: 2px solid rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
            color: #333333;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            position: relative;
        }

        .form-group select {
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23333333" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 20px;
            padding-right: 45px;
            cursor: pointer;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #666666;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
            background-color: #fafafa;
        }

        .form-group select:hover {
            border-color: #666666;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .button-group {
            display: flex;
            justify-content: center;
        }

        .btn {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 600;
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-top: 24px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
        }

        .calendar-container {
            padding: 20px;
            background: white;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            justify-content: center;
        }

        .calendar-month {
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.1);
            overflow: hidden;
            width: 100%;
            min-width: 350px;
        }

        .month-header {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 600;
            background: linear-gradient(135deg, #2c2c2c 0%, #1a1a1a 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.3em;
        }

        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .calendar-table th {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 600;
            background: linear-gradient(135deg, #f8f8f8 0%, #e8e8e8 100%);
            padding: 12px 4px;
            font-size: 0.9em;
            color: #333333;
            text-align: center;
            border-bottom: 2px solid rgba(0, 0, 0, 0.2);
            width: 14.28%;
            word-wrap: break-word;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-width: 0;
        }

        .calendar-table td {
            width: 14.28%;
            height: 60px;
            padding: 4px 2px;
            text-align: center;
            border: 1px solid rgba(0, 0, 0, 0.08);
            vertical-align: top;
            position: relative;
            background: white;
            word-wrap: break-word;
            overflow: hidden;
        }

        .date-number {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 600;
            color: #333333;
            font-size: 0.95em;
            line-height: 1.2;
        }

        .japanese-reading {
            font-family: "Noto Sans JP", "Noto Sans TC", "Sora", sans-serif;
            font-weight: 500;
            font-size: 0.6em;
            color: #666666;
            margin-top: 1px;
            line-height: 1;
        }

        /* 台灣假日 - 白底紅字 */
        .taiwan-holiday {
            background-color: white !important;
            color: #ff0000 !important;
        }

        .taiwan-holiday .date-number {
            color: #ff0000 !important;
            font-weight: 700;
        }

        .taiwan-holiday .japanese-reading {
            color: #cc0000 !important;
        }

        .taiwan-holiday .holiday-name {
            color: #ff0000 !important;
        }

        /* 日本假日 - 白底橘字 */
        .japan-holiday {
            background-color: white !important;
            color: #ff6600 !important;
        }

        .japan-holiday .date-number {
            color: #ff6600 !important;
            font-weight: 700;
        }

        .japan-holiday .japanese-reading {
            color: #cc5200 !important;
        }

        .japan-holiday .holiday-name {
            color: #ff6600 !important;
        }

        /* 兩國都有假日時的處理 */
        .both-holiday {
            background: white !important;
            color: #ff0000 !important;
            position: relative;
        }

        .both-holiday::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,0,0,0.1) 50%, rgba(255,102,0,0.1) 50%);
            pointer-events: none;
        }

        .both-holiday .date-number {
            color: #ff0000 !important;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .both-holiday .japanese-reading {
            color: #cc0000 !important;
            position: relative;
            z-index: 1;
        }

        .both-holiday .holiday-name {
            color: #ff0000 !important;
            position: relative;
            z-index: 1;
        }

        .weekend {
            background-color: white !important;
        }

        .weekend .date-number {
            color: #ff0000 !important;
            font-weight: 700;
        }

        .weekend .japanese-reading {
            color: #cc0000 !important;
        }

        .other-month {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .other-month .date-number {
            color: #cccccc;
        }

        .holiday-name {
            font-family: "Noto Sans TC", "Noto Sans JP", "Sora", sans-serif;
            font-weight: 500;
            font-size: 0.6em;
            color: #333333;
            margin-top: 2px;
            line-height: 1.1;
            word-break: break-all;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ruby {
            ruby-align: center;
        }

        .ruby rt {
            font-size: 0.6em;
            color: inherit;
        }

        .loading {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 400;
            text-align: center;
            padding: 50px;
            color: #666666;
            font-size: 1.1em;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(0, 0, 0, 0.2);
            border-top: 2px solid #333333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message, .success-message {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 500;
            padding: 15px 20px;
            border-radius: 20px;
            margin: 20px;
        }

        .error-message {
            background: linear-gradient(135deg, #ffebee 0%, #fde7e9 100%);
            color: #c62828;
            border-left: 4px solid #c62828;
        }

        .success-message {
            background: linear-gradient(135deg, #f0f0f0 0%, #e8e8e8 100%);
            color: #333333;
            border-left: 4px solid #666666;
        }

        .footer {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333333;
            padding: 20px;
            text-align: center;
            margin-top: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .footer-made {
            font-family: "Sora", "Noto Sans TC", "Noto Sans JP", sans-serif;
            font-weight: 500;
            font-size: 14px;
            opacity: 0.8;
            color: #666666;
        }

        .footer-heart {
            color: #ff4757;
            font-size: 1.1em;
            margin-left: 5px;
            animation: heartbeat 1.5s ease-in-out infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @media (max-width: 1200px) {
            .control-group {
                grid-template-columns: repeat(3, 1fr);
                gap: 15px;
            }
        }

        @media (max-width: 768px) {
            .control-group {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1em;
                margin-top: 15px;
            }
            
            .calendar-grid {
                grid-template-columns: 1fr;
            }
            
            .calendar-month {
                min-width: unset;
                border-radius: 16px;
            }
            
            .calendar-table th,
            .calendar-table td {
                padding: 6px 2px;
                font-size: 0.8em;
                height: 50px;
            }

            .calendar-table th {
                font-size: 0.6em !important;
                padding: 6px 1px !important;
                line-height: 1.1 !important;
            }
            
            .holiday-name {
                font-size: 0.55em;
            }

            .container {
                border-radius: 16px;
            }
        }

        @media print {
            .controls, .button-group, .footer {
                display: none !important;
            }
            
            .calendar-container {
                padding: 0;
            }
            
            .calendar-month {
                page-break-inside: avoid;
                margin-bottom: 20px;
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>月曆生成器</h1>
            <p class="subtitle">台灣和日本月曆</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="form-group">
                    <label for="year">年份</label>
                    <input type="number" id="year" min="2020" max="2030" value="2025">
                </div>
                
                <div class="form-group">
                    <label for="startMonth">起始月份</label>
                    <select id="startMonth">
                        <option value="1">一月</option>
                        <option value="2">二月</option>
                        <option value="3">三月</option>
                        <option value="4">四月</option>
                        <option value="5">五月</option>
                        <option value="6">六月</option>
                        <option value="7">七月</option>
                        <option value="8">八月</option>
                        <option value="9">九月</option>
                        <option value="10">十月</option>
                        <option value="11">十一月</option>
                        <option value="12">十二月</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="monthCount">月份數量</label>
                    <select id="monthCount">
                        <option value="1">1 個月</option>
                        <option value="3">3 個月</option>
                        <option value="6">6 個月</option>
                        <option value="12" selected>12 個月</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="country">國家地區</label>
                    <select id="country">
                        <option value="taiwan">台灣</option>
                        <option value="taiwan-en-full">台灣 （英文完整版）</option>
                        <option value="taiwan-en-short">台灣 （英文縮寫）</option>
                        <option value="taiwan-en-abbr">台灣 （英文簡寫）</option>
                        <option value="japan">日本（振假名）</option>
                        <option value="japan-hiragana">日本（平假名）</option>
                        <option value="japan-kanji">日本（漢字）</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="weekStart">週起始日</label>
                    <select id="weekStart">
                        <option value="0">星期日</option>
                        <option value="1" selected>星期一</option>
                    </select>
                </div>

                <div class="form-group">
                    <button class="btn btn-primary" onclick="generateCalendar()">
                        產生月曆
                    </button>
                </div>
            </div>
        </div>

        <div class="calendar-container" id="calendarContainer">
            <div class="loading" id="loading" style="display: none;">
                正在生成月曆...
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
        </div>

        <div class="footer">
            <div class="footer-made">
                <span>Made in Taiwan with</span>
                <span class="footer-heart">❤️</span>
            </div>
        </div>
    </div>

    <script>
        // 根據政府行政機關辦公日曆表更新的台灣節日資料
        const holidays = {
            taiwan: {
                2025: {
                    '1-1': '中華民國開國紀念日',
                    '1-27': '農曆除夕前一日',
                    '1-28': '農曆除夕',
                    '1-29': '農曆春節',
                    '1-30': '農曆春節',
                    '1-31': '農曆春節',
                    '2-28': '和平紀念日',
                    '4-3': '兒童節補假',
                    '4-4': '兒童節',
                    '4-5': '民族掃墓節',
                    '5-1': '勞動節',
                    '5-30': '端午節補假',
                    '5-31': '端午節',
                    '9-28': '孔子誕辰紀念日',
                    '9-29': '孔子誕辰紀念日補假',
                    '10-6': '中秋節',
                    '10-10': '國慶日',
                    '10-24': '臺灣光復節補假',
                    '10-25': '臺灣光復節',
                    '12-25': '行憲紀念日'
                },
                2026: {
                    '1-1': '中華民國開國紀念日',
                    '2-15': '農曆除夕前一日',
                    '2-16': '農曆除夕',
                    '2-17': '農曆春節',
                    '2-18': '農曆春節',
                    '2-19': '農曆春節',
                    '2-20': '農曆除夕前一日補假',
                    '2-27': '和平紀念日補假',
                    '2-28': '和平紀念日',
                    '4-3': '兒童節補假',
                    '4-4': '兒童節',
                    '4-5': '民族掃墓節',
                    '4-6': '民族掃墓節補假',
                    '5-1': '勞動節',
                    '6-19': '端午節',
                    '9-25': '中秋節',
                    '9-28': '孔子誕辰紀念日',
                    '10-9': '國慶日補假',
                    '10-10': '國慶日',
                    '10-24': '臺灣光復節補假',
                    '10-25': '臺灣光復節',
                    '12-25': '行憲紀念日'
                }
            },
            japan: {
                // 振假名版本
                ruby: {
                    2025: {
                        '1-1': '<ruby>元日<rt>がんじつ</rt></ruby>',
                        '1-13': '<ruby>成人<rt>せいじん</rt></ruby>の<ruby>日<rt>ひ</rt></ruby>',
                        '2-11': '<ruby>建国記念<rt>けんこくきねん</rt></ruby>の<ruby>日<rt>ひ</rt></ruby>',
                        '2-23': '<ruby>天皇誕生日<rt>てんのうたんじょうび</rt></ruby>',
                        '3-20': '<ruby>春分<rt>しゅんぶん</rt></ruby>の<ruby>日<rt>ひ</rt></ruby>',
                        '4-29': '<ruby>昭和<rt>しょうわ</rt></ruby>の<ruby>日<rt>ひ</rt></ruby>',
                        '5-3': '<ruby>憲法記念日<rt>けんぽうきねんび</rt></ruby>',
                        '5-4': 'みどりの<ruby>日<rt>ひ</rt></ruby>',
                        '5-5': 'こどもの<ruby>日<rt>ひ</rt></ruby>',
                        '7-21': '<ruby>海<rt>うみ</rt></ruby>の<ruby>日<rt>ひ</rt></ruby>',
                        '8-11': 'やまのひ',
                        '9-15': 'けいろうのひ',
                        '9-23': 'しゅうぶんのひ',
                        '10-13': 'スポーツのひ',
                        '11-3': 'ぶんかのひ',
                        '11-23': 'きんろうかんしゃのひ'
                    }
                },
                // 漢字版本
                kanji: {
                    2025: {
                        '1-1': '元日',
                        '1-13': '成人の日',
                        '2-11': '建国記念の日',
                        '2-23': '天皇誕生日',
                        '3-20': '春分の日',
                        '4-29': '昭和の日',
                        '5-3': '憲法記念日',
                        '5-4': 'みどりの日',
                        '5-5': 'こどもの日',
                        '7-21': '海の日',
                        '8-11': '山の日',
                        '9-15': '敬老の日',
                        '9-23': '秋分の日',
                        '10-13': 'スポーツの日',
                        '11-3': '文化の日',
                        '11-23': '勤労感謝の日'
                    }
                }
            }
        };

        // 日文月份讀音
        const japaneseMonths = {
            1: 'いちがつ', 2: 'にがつ', 3: 'さんがつ', 4: 'しがつ',
            5: 'ごがつ', 6: 'ろくがつ', 7: 'しちがつ', 8: 'はちがつ',
            9: 'くがつ', 10: 'じゅうがつ', 11: 'じゅういちがつ', 12: 'じゅうにがつ'
        };

        // 日文日期讀音
        const japaneseDays = {
            1: 'ついたち', 2: 'ふつか', 3: 'みっか', 4: 'よっか', 5: 'いつか',
            6: 'むいか', 7: 'なのか', 8: 'ようか', 9: 'ここのか', 10: 'とおか',
            11: 'じゅういちにち', 12: 'じゅうににち', 13: 'じゅうさんにち', 14: 'じゅうよっか', 15: 'じゅうごにち',
            16: 'じゅうろくにち', 17: 'じゅうしちにち', 18: 'じゅうはちにち', 19: 'じゅうくにち', 20: 'はつか',
            21: 'にじゅういちにち', 22: 'にじゅうににち', 23: 'にじゅうさんにち', 24: 'にじゅうよっか', 25: 'にじゅうごにち',
            26: 'にじゅうろくにち', 27: 'にじゅうしちにち', 28: 'にじゅうはちにち', 29: 'にじゅうくにち', 30: 'さんじゅうにち',
            31: 'さんじゅういちにち'
        };

        let currentCalendarData = [];

        function generateCalendar() {
            const year = parseInt(document.getElementById('year').value);
            const startMonth = parseInt(document.getElementById('startMonth').value);
            const monthCount = parseInt(document.getElementById('monthCount').value);
            const country = document.getElementById('country').value;
            const weekStart = parseInt(document.getElementById('weekStart').value);

            const loading = document.getElementById('loading');
            const calendarGrid = document.getElementById('calendarGrid');

            loading.style.display = 'block';
            calendarGrid.innerHTML = '';

            setTimeout(() => {
                currentCalendarData = [];
                calendarGrid.innerHTML = '';

                for (let i = 0; i < monthCount; i++) {
                    let currentMonth = startMonth + i;
                    let currentYear = year;

                    if (currentMonth > 12) {
                        currentMonth = currentMonth - 12;
                        currentYear = year + 1;
                    }

                    const monthData = createMonthCalendar(currentYear, currentMonth, country, weekStart);
                    currentCalendarData.push(monthData);
                    calendarGrid.appendChild(createMonthElement(monthData, country, weekStart));
                }

                loading.style.display = 'none';
            }, 500);
        }

        // 獲取令和年份
        function getReiwaYear(year) {
            if (year < 2019) return '';
            const reiwaYear = year - 2018;
            return reiwaYear === 1 ? '元' : reiwaYear.toString();
        }

        function createMonthCalendar(year, month, country, weekStart) {
            const monthNames = [
                '', '一月', '二月', '三月', '四月', '五月', '六月',
                '七月', '八月', '九月', '十月', '十一月', '十二月'
            ];

            const daysInMonth = new Date(year, month, 0).getDate();
            const firstDayOfMonth = new Date(year, month - 1, 1).getDay();
            
            let adjustedFirstDay = (firstDayOfMonth - weekStart + 7) % 7;
            
            const monthData = {
                year: year,
                month: month,
                monthName: getMonthHeaderText(year, month, country),
                days: [],
                weekStart: weekStart
            };

            // 填入上個月的日期
            const prevMonth = month === 1 ? 12 : month - 1;
            const prevYear = month === 1 ? year - 1 : year;
            const daysInPrevMonth = new Date(prevYear, prevMonth, 0).getDate();

            for (let i = adjustedFirstDay - 1; i >= 0; i--) {
                monthData.days.push({
                    date: daysInPrevMonth - i,
                    isCurrentMonth: false,
                    isWeekend: false,
                    holidays: []
                });
            }

            // 填入當月的日期
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month - 1, day);
                const dayOfWeek = date.getDay();
                const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
                
                const dateKey = `${month}-${day}`;
                const dayHolidays = getHolidays(year, dateKey, country);

                monthData.days.push({
                    date: day,
                    isCurrentMonth: true,
                    isWeekend: isWeekend,
                    holidays: dayHolidays
                });
            }

            // 填入下個月的日期
            const totalCells = Math.ceil(monthData.days.length / 7) * 7;
            const nextMonth = month === 12 ? 1 : month + 1;
            let nextDay = 1;

            for (let i = monthData.days.length; i < totalCells; i++) {
                monthData.days.push({
                    date: nextDay++,
                    isCurrentMonth: false,
                    isWeekend: false,
                    holidays: []
                });
            }

            return monthData;
        }

        function getMonthHeaderText(year, month, country) {
            switch(country) {
                case 'taiwan-en-full':
                case 'taiwan-en-short':
                case 'taiwan-en-abbr':
                    const monthNames = ['', 'January', 'February', 'March', 'April', 'May', 'June',
                                       'July', 'August', 'September', 'October', 'November', 'December'];
                    return `${monthNames[month]} ${year}`;
                case 'japan':
                    return `${year}<ruby>年<rt>ねん</rt></ruby> (<ruby>令和<rt>れいわ</rt></ruby>${getReiwaYear(year)}<ruby>年<rt>ねん</rt></ruby>) ${month}<ruby>月<rt>${japaneseMonths[month]}</rt></ruby>`;
                case 'japan-hiragana':
                    return `${year}ねん (れいわ${getReiwaYear(year)}ねん) ${month}がつ`;
                case 'japan-kanji':
                    return `${year}年 (令和${getReiwaYear(year)}年) ${month}月`;
                default:
                    return `${year} 年 ${month} 月`;
            }
        }

        function getHolidays(year, dateKey, country) {
            const holidayList = [];
            
            // 台灣英文版不顯示假日
            if (country === 'taiwan-en-full' || country === 'taiwan-en-short' || country === 'taiwan-en-abbr') {
                return holidayList;
            }
            
            if (country === 'taiwan' || country === 'both') {
                if (holidays.taiwan[year] && holidays.taiwan[year][dateKey]) {
                    holidayList.push({
                        name: holidays.taiwan[year][dateKey],
                        country: 'taiwan'
                    });
                }
            }
            
            if (country === 'japan' || country === 'both') {
                if (holidays.japan.ruby[year] && holidays.japan.ruby[year][dateKey]) {
                    holidayList.push({
                        name: holidays.japan.ruby[year][dateKey],
                        country: 'japan'
                    });
                }
            }

            if (country === 'japan-hiragana') {
                if (holidays.japan.hiragana[year] && holidays.japan.hiragana[year][dateKey]) {
                    holidayList.push({
                        name: holidays.japan.hiragana[year][dateKey],
                        country: 'japan'
                    });
                }
            }

            if (country === 'japan-kanji') {
                if (holidays.japan.kanji[year] && holidays.japan.kanji[year][dateKey]) {
                    holidayList.push({
                        name: holidays.japan.kanji[year][dateKey],
                        country: 'japan'
                    });
                }
            }
            
            return holidayList;
        }

        function createMonthElement(monthData, country, weekStart) {
            const monthDiv = document.createElement('div');
            monthDiv.className = 'calendar-month';
            
            const weekHeaders = getWeekHeaders(country, weekStart);
            
            monthDiv.innerHTML = `
                <div class="month-header">
                    ${monthData.monthName}
                </div>
                <table class="calendar-table">
                    <thead>
                        <tr>
                            ${weekHeaders}
                        </tr>
                    </thead>
                    <tbody>
                        ${createWeekRows(monthData.days, country)}
                    </tbody>
                </table>
            `;

            return monthDiv;
        }

        function getWeekHeaders(country, weekStart) {
            const baseHeaders = weekStart === 0 
                ? ['日', '一', '二', '三', '四', '五', '六']
                : ['一', '二', '三', '四', '五', '六', '日'];

            const englishHeadersFull = weekStart === 0 
                ? ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
                : ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            const englishHeadersShort = weekStart === 0 
                ? ['S', 'M', 'T', 'W', 'T', 'F', 'S']
                : ['M', 'T', 'W', 'T', 'F', 'S', 'S'];

            const englishHeadersAbbr = weekStart === 0 
                ? ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']
                : ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];

            switch(country) {
                case 'taiwan-en-full':
                    return englishHeadersFull.map((day, index) => {
                        const isWeekend = (weekStart === 0 && (index === 0 || index === 6)) || 
                                         (weekStart === 1 && (index === 5 || index === 6));
                        const style = isWeekend ? 'color: #ff0000; font-weight: 700;' : 'color: #333333;';
                        return `<th style="font-size: 0.65em; padding: 8px 2px; line-height: 1.2; ${style}">${day}</th>`;
                    }).join('');

                case 'taiwan-en-short':
                    return englishHeadersShort.map((day, index) => {
                        const isWeekend = (weekStart === 0 && (index === 0 || index === 6)) || 
                                         (weekStart === 1 && (index === 5 || index === 6));
                        const style = isWeekend ? 'color: #ff0000; font-weight: 700;' : 'color: #333333;';
                        return `<th style="${style}">${day}</th>`;
                    }).join('');

                case 'taiwan-en-abbr':
                    return englishHeadersAbbr.map((day, index) => {
                        const isWeekend = (weekStart === 0 && (index === 0 || index === 6)) || 
                                         (weekStart === 1 && (index === 5 || index === 6));
                        const style = isWeekend ? 'color: #ff0000; font-weight: 700;' : 'color: #333333;';
                        return `<th style="${style}">${day}</th>`;
                    }).join('');

                case 'japan':
                    const weekHeadersJapanese = weekStart === 0 
                        ? [
                            '<ruby>日曜日<rt>にちようび</rt></ruby>',
                            '<ruby>月曜日<rt>げつようび</rt></ruby>',
                            '<ruby>火曜日<rt>かようび</rt></ruby>',
                            '<ruby>水曜日<rt>すいようび</rt></ruby>',
                            '<ruby>木曜日<rt>もくようび</rt></ruby>',
                            '<ruby>金曜日<rt>きんようび</rt></ruby>',
                            '<ruby>土曜日<rt>どようび</rt></ruby>'
                        ]
                        : [
                            '<ruby>月曜日<rt>げつようび</rt></ruby>',
                            '<ruby>火曜日<rt>かようび</rt></ruby>',
                            '<ruby>水曜日<rt>すいようび</rt></ruby>',
                            '<ruby>木曜日<rt>もくようび</rt></ruby>',
                            '<ruby>金曜日<rt>きんようび</rt></ruby>',
                            '<ruby>土曜日<rt>どようび</rt></ruby>',
                            '<ruby>日曜日<rt>にちようび</rt></ruby>'
                        ];
                    return weekHeadersJapanese.map(day => `<th style="font-size: 0.8em; color: #333333;">${day}</th>`).join('');

                case 'japan-hiragana':
                    const weekHeadersHiragana = weekStart === 0 
                        ? ['にちようび', 'げつようび', 'かようび', 'すいようび', 'もくようび', 'きんようび', 'どようび']
                        : ['げつようび', 'かようび', 'すいようび', 'もくようび', 'きんようび', 'どようび', 'にちようび'];
                    return weekHeadersHiragana.map(day => `<th style="font-size: 0.75em; color: #333333;">${day}</th>`).join('');

                case 'japan-kanji':
                    const weekHeadersKanji = weekStart === 0 
                        ? ['日曜日', '月曜日', '火曜日', '水曜日', '木曜日', '金曜日', '土曜日']
                        : ['月曜日', '火曜日', '水曜日', '木曜日', '金曜日', '土曜日', '日曜日'];
                    return weekHeadersKanji.map(day => `<th style="font-size: 0.85em; color: #333333;">${day}</th>`).join('');

                default:
                    return baseHeaders.map((day, index) => {
                        const isWeekend = (weekStart === 0 && (index === 0 || index === 6)) || 
                                         (weekStart === 1 && (index === 5 || index === 6));
                        const style = isWeekend ? 'color: #ff0000; font-weight: 700;' : 'color: #333333;';
                        return `<th style="${style}">${day}</th>`;
                    }).join('');
            }
        }

        function createWeekRows(days, country) {
            let html = '';
            for (let i = 0; i < days.length; i += 7) {
                html += '<tr>';
                for (let j = 0; j < 7; j++) {
                    const day = days[i + j];
                    if (day) {
                        let className = '';
                        if (!day.isCurrentMonth) {
                            className = 'other-month';
                        } else if (day.holidays.length > 0) {
                            // 區分台灣和日本假期的顏色
                            const hasJapanHoliday = day.holidays.some(h => h.country === 'japan');
                            const hasTaiwanHoliday = day.holidays.some(h => h.country === 'taiwan');
                            
                            if (hasJapanHoliday && hasTaiwanHoliday) {
                                className = 'both-holiday';
                            } else if (hasJapanHoliday) {
                                className = 'japan-holiday';
                            } else if (hasTaiwanHoliday) {
                                className = 'taiwan-holiday';
                            }
                        } else if (day.isWeekend) {
                            className = 'weekend';
                        }

                        const holidayNames = day.holidays.map(h => 
                            `<div class="holiday-name">${h.name}</div>`
                        ).join('');

                        let japaneseReading = '';
                        if ((country.includes('japan')) && day.isCurrentMonth) {
                            japaneseReading = `<div class="japanese-reading">${japaneseDays[day.date]}</div>`;
                        }

                        html += `
                            <td class="${className}">
                                <div class="date-number">${day.date}</div>
                                ${japaneseReading}
                                ${holidayNames}
                            </td>
                        `;
                    }
                }
                html += '</tr>';
            }
            return html;
        }

        function showMessage(message, type) {
            const existingMessages = document.querySelectorAll('.success-message, .error-message');
            existingMessages.forEach(msg => msg.remove());
            
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
            messageDiv.innerHTML = message;
            
            const container = document.querySelector('.calendar-container');
            container.insertBefore(messageDiv, container.firstChild);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 4000);
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            const currentYear = new Date().getFullYear();
            
            document.getElementById('year').value = currentYear;
            document.getElementById('startMonth').value = 1;
        });
    </script>
</body>
</html>
